## <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
## <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
## <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<link href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/bootstrap3-editable/css/bootstrap-editable.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/bootstrap3-editable/js/bootstrap-editable.min.js"></script>


<%page expression_filter="h"/>
##<%inherit file="main.html" />
<%namespace name='static' file='../static_content.html'/>

<%!
from django.core.urlresolvers import reverse
%>

<%block name="header_extras">
% for template_name in ["donation"]:
<script type="text/template" id="${template_name}-tpl">
  <%static:include path="dashboard/${template_name}.underscore" />
</script>
% endfor
</%block>

    <style>
        section {
            font-family: Helvetica;
        }

        td a{
            color: #333;
            text-decoration: none;
        }

        a:visited {
            text-decoration:  none;
        }
    </style>


    <section class="container dashboard" id="dashboard-main">

      <br><br>

         <ol class="breadcrumb">
          <li><a href="${marketing_link('ROOT')}">ALUx Platform</a></li>
          <li><a href="${reverse('skills_map:skills-hq')}">HQ</a></li>
          <li class="active">LO Bank</li>
        </ol>

        <h1>Learning Outcome Bank</h1>


        <hr style="padding:0px;height:3px;border:none;color:#eee;background-color:#eee;">

        <div class="row">
            <div class="col-md-6">

                <!-- Buttons at top of screeen -->
                 <div class="row">
                    <div class="col-md-2">
                        <a type="button" class="btn btn-danger" id="delete-item-modal">
                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Delete
                             ## Delete ${item.get_child_type()._meta.verbose_name}
                        </a>
                    </div>

                    <div class="col-md-2">
                        <a type="button" class="btn btn-default" id="create-item-modal">
                            <i class="fa fa-plus"></i> Add
                            ## Add ${item.get_child_type()._meta.verbose_name}
                        </a>
                    </div>

                </div>
            </div>
        </div>


        <br>

        <div class="row col-sm-12">
            <table id="lo-table" class="table table-striped table-bordered" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th>LO</th>
                        <th>Description</th>
                        <th>L 1</th>
                        <th>L 2</th>
                        <th>L 3</th>
                        <th>L 4</th>
                        <th>L 5</th>
                    </tr>
                </thead>
                <tbody>
                    % for learning_outcome in learning_outcomes:
                        <tr>
                            <td> <a href="#" id="lo-name-${learning_outcome.get('id', 'none')}"
                                    data-value="${learning_outcome.get('name', '')}"></a> </td>

                            <td> <a href="#" id="lo-description-${learning_outcome.get('id', 'none')}"
                                    data-value="${learning_outcome.get('description', '')}"></a> </td>

                            <td> <a href="#" id="lo-l1-${learning_outcome.get('id', 'none')}"
                                    data-value="${learning_outcome.get('l1', '')}"></a> </td>

                            <td> <a href="#" id="lo-l2-${learning_outcome.get('id', 'none')}"
                                    data-value="${learning_outcome.get('l2', '')}"></a> </td>

                            <td> <a href="#" id="lo-l3-${learning_outcome.get('id', 'none')}"
                                    data-value="${learning_outcome.get('l3', '')}"></a> </td>

                            <td> <a href="#" id="lo-l4-${learning_outcome.get('id', 'none')}"
                                    data-value="${learning_outcome.get('l4', '')}"></a> </td>

                            <td> <a href="#" id="lo-l5-${learning_outcome.get('id', 'none')}"
                                    data-value="${learning_outcome.get('l5', '')}"></a> </td>

                        </tr>
                    %endfor
                </tbody>
            </table>
        </div>

    </section>


    <div id="create-modal" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">

        <!-- Modal content-->
            <div class="modal-content">

                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">
                        Add a Learning Outcome
                    </h4>
                </div>

              <div class="modal-body">
                 <form action="${reverse('skills_map:add-learning-outcome')}" method="post">
                     <input type="hidden" name="csrfmiddlewaretoken" value="${ csrf_token }">

                    <div class="input-group">
                        <span class="input-group-addon" id="basic-addon1"><span class="glyphicon glyphicon-tag" aria-hidden="true"></span></span>
                        <input type="text" name="lo-name" class="form-control" placeholder="LO Name" id="title">
                    </div>

                     <br>

                    <input class="btn btn-default pull-right" type="submit" value="Create">
                    <br>
                    <br>

                 </form>
              </div>

            </div>

        </div>
    </div>


<!-- Delete modal -->

<div id="delete-modal" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg">

    <!-- Modal content-->
    <div class="modal-content">

        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">
                Delete a Learning Outcome
            </h4>
        </div>

      <div class="modal-body">
         <form action="${reverse('skills_map:delete-learning-outcome')}" method="post">
             <input type="hidden" name="csrfmiddlewaretoken" value="${ csrf_token }">

              <div class="input-group">

                  <div class="form-group">
                      <label for="sel1">Select an LO to delete:</label>
                      <select class="form-control" name="lo-id">
                          % for learning_outcome in learning_outcomes:
                             <option value="${learning_outcome.get('id')}">${learning_outcome.get('name')}</option>
                          % endfor
                      </select>
                  </div>


                </div>
                <br>
                <br>
            <input class="btn btn-danger pull-right" type="submit" value="Delete">
            <br>
            <br>

         </form>
      </div>

    </div>


    </div>
</div>

<script>
    $('#create-item-modal').click(function() {
        $('#create-modal').modal('show');
    });


    $('#delete-item-modal').click(function() {
        $('#delete-modal').modal('show');
    });
</script>

<script>
    $(document).ready(function() {
        $.fn.editable.defaults.mode = 'popup';

         % for learning_outcome in learning_outcomes:

             $('#lo-name-${learning_outcome.get('id')}').editable({
                 type: 'text',
                 title: 'Edit LO Name',
                 placement: 'right',
                 url: '${reverse('skills_map:edit-learning-outcome')}',
                 value: "",
                 pk:1,
                 params: function(params) {
                     var data = {};
                     data['id'] = params.name;
                     data['value'] = params.value;
                     data['item'] = 'name';
                     data['lo-id'] = ${learning_outcome.get('id')};
                     data['csrfmiddlewaretoken'] = '${ csrf_token }';
                     return data;
                 },
                 success: function(response) {
                     location.reload();
                 },
             });

             $('#lo-description-${learning_outcome.get('id')}').editable({
                 type: 'textarea',
                 title: 'Edit LO Description',
                 placement: 'right',
                 rows: 4,
                 escape: false,
                 url: '${reverse('skills_map:edit-learning-outcome')}',
                 value: "",
                 pk:1,
                 params: function(params) {
                     var data = {};
                     data['id'] = params.name;
                     data['value'] = params.value;
                     data['item'] = 'description';
                     data['lo-id'] = ${learning_outcome.get('id')};
                     data['csrfmiddlewaretoken'] = '${ csrf_token }';
                     return data;
                 },
                 success: function(response) {
                     location.reload();
                 },
             });

             $('#lo-l1-${learning_outcome.get('id')}').editable({
                 type: 'textarea',
                 title: 'Edit Level 1 Description',
                 placement: 'right',
                 rows: 4,
                 escape: false,
                 url: '${reverse('skills_map:edit-learning-outcome')}',
                 value: "",
                 pk:1,
                 params: function(params) {
                     var data = {};
                     data['id'] = params.name;
                     data['value'] = params.value;
                     data['item'] = 'l1';
                     data['lo-id'] = ${learning_outcome.get('id')};
                     data['csrfmiddlewaretoken'] = '${ csrf_token }';
                     return data;
                 },
                 success: function(response) {
                     location.reload();
                 },
             });

             $('#lo-l2-${learning_outcome.get('id')}').editable({
                 type: 'textarea',
                 title: 'Edit Level 2 Description',
                 placement: 'right',
                 rows: 4,
                 escape: false,
                 url: '${reverse('skills_map:edit-learning-outcome')}',
                 value: "",
                 pk:1,
                 params: function(params) {
                     var data = {};
                     data['id'] = params.name;
                     data['value'] = params.value;
                     data['item'] = 'l2';
                     data['lo-id'] = ${learning_outcome.get('id')};
                     data['csrfmiddlewaretoken'] = '${ csrf_token }';
                     return data;
                 },
                 success: function(response) {
                     location.reload();
                 },
             });

             $('#lo-l3-${learning_outcome.get('id')}').editable({
                 type: 'textarea',
                 title: 'Edit Level 3 Description',
                 placement: 'right',
                 rows: 4,
                 escape: false,
                 url: '${reverse('skills_map:edit-learning-outcome')}',
                 value: "",
                 pk:1,
                 params: function(params) {
                     var data = {};
                     data['id'] = params.name;
                     data['value'] = params.value;
                     data['item'] = 'l3';
                     data['lo-id'] = ${learning_outcome.get('id')};
                     data['csrfmiddlewaretoken'] = '${ csrf_token }';
                     return data;
                 },
                 success: function(response) {
                     location.reload();
                 },
             });

             $('#lo-l4-${learning_outcome.get('id')}').editable({
                 type: 'textarea',
                 title: 'Edit Level 4 Description',
                 placement: 'right',
                 rows: 4,
                 escape: false,
                 url: '${reverse('skills_map:edit-learning-outcome')}',
                 value: "",
                 pk:1,
                 params: function(params) {
                     var data = {};
                     data['id'] = params.name;
                     data['value'] = params.value;
                     data['item'] = 'l4';
                     data['lo-id'] = ${learning_outcome.get('id')};
                     data['csrfmiddlewaretoken'] = '${ csrf_token }';
                     return data;
                 },
                 success: function(response) {
                     location.reload();
                 },
             });

             $('#lo-l5-${learning_outcome.get('id')}').editable({
                 type: 'textarea',
                 title: 'Edit Level 5 Description',
                 placement: 'right',
                 rows: 4,
                 escape: false,
                 url: '${reverse('skills_map:edit-learning-outcome')}',
                 value: "",
                 pk:1,
                 params: function(params) {
                     var data = {};
                     data['id'] = params.name;
                     data['value'] = params.value;
                     data['item'] = 'l5';
                     data['lo-id'] = ${learning_outcome.get('id')};
                     data['csrfmiddlewaretoken'] = '${ csrf_token }';
                     return data;
                 },
                 success: function(response) {
                     location.reload();
                 },
             });

         % endfor
    });

</script>